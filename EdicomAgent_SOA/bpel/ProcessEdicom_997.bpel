<?xml version="1.0" encoding="UTF-8"?>
<bpel:process xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
              xmlns:EBIBrokerWebServiceV2="http://com.edicom.broker.adapter.services"
              xmlns:txn-audit="http://www.sunpower.com/middleware/realtime/txn-audit/wsdl/1.0"
              xmlns:ns="http://ProcessEdicomFiles/processedicomfiles/public"
              xmlns:csvtoxml="http://www.sunpower.com/middleware/realtime/sunpower/agent/csvtoxml/xquery/1.0"
              xmlns:aei="http://www.activebpel.org/2009/02/bpel/extension/ignorable"
              xmlns:ext="http://www.activebpel.org/2006/09/bpel/extension/query_handling"
              xmlns:Edicom_PLT="http://www.sunpower.com/middleware/realtime/PLT/wsdl/1.0"
              xmlns:das="http://schemas.active-endpoints.com/data-access/2010/04/data-access.xsd"
              xmlns:ext1="http://www.activebpel.org/2009/06/bpel/extension/links"
              xmlns:ext2="http://www.activebpel.org/2011/08/bpel/extension/script"
              xmlns:abx="http://www.activebpel.org/bpel/extension"
              xmlns:data-access="http://docs.active-endpoints/wsdl/data-access/2010/04/data-access.wsdl"
              xmlns:xsd="http://www.w3.org/2001/XMLSchema"
              xmlns:ediQ_SOA="http://www.sunpower.com/middleware/realtime/edicom_soa/xquery/1.0"
              xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"
              xmlns:Txn_Audit.public="http://Txn_Audit/txn_audit/public"
              aei:editStyle="BPMN"
              ext1:linksAreTransitions="yes"
              ext:createTargetXPath="yes"
              ext:disableSelectionFailure="yes"
              name="ProcessEdicom_997"
              suppressJoinFailure="yes"
              targetNamespace="http://ProcessEdicom_997">
   <bpmndi:BPMNDiagram xmlns:dc="http://www.omg.org/spec/DD/20100524/DC"
                       xmlns:di="http://www.omg.org/spec/DD/20100524/DI"
                       aei:bpelDigest=""
                       aei:editStyle="BPMN"
                       aei:layoutNeeded="false"
                       aei:modelVersion="5"
                       aei:objectId="144039199924711319"
                       aei:processInitiatorSim=""
                       isHorizontal="true">
      <bpmndi:BPMNPlane>
         <bpmndi:BPMNShape aei:backgroundImageLocation="icons/bpmn/activity/ActivityBlock.png"
                           aei:objectId="144039203409512209"
                           aei:type="PARTNER_LINK"
                           aei:visible="false,false,false,false,false,"
                           bpmnElement="144039203409512209"/>
         <bpmndi:BPMNShape aei:backgroundImageLocation="icons/bpmn/activity/ActivityBlock.png"
                           aei:objectId="144039261505318531"
                           aei:type="PARTNER_LINK"
                           aei:visible="false,false,false,false,false,"
                           bpmnElement="144039261505318531"/>
         <bpmndi:BPMNShape aei:backgroundImageLocation="icons/bpmn/activity/ActivityBlock.png"
                           aei:objectId="144042792157028151"
                           aei:type="PARTNER_LINK"
                           aei:visible="false,false,false,false,false,"
                           bpmnElement="144042792157028151"/>
         <bpmndi:BPMNShape aei:backgroundImageLocation="icons/bpmn/activity/ActivityBlock.png"
                           aei:objectId="144044505385655211"
                           aei:type="PARTNER_LINK"
                           aei:visible="false,false,false,false,false,"
                           bpmnElement="144044505385655211"/>
         <bpmndi:BPMNShape aei:absoluteLocation="LOC {141,136}"
                           aei:absoluteSize="DIM {1953,488}"
                           aei:objectId="144039208093112435"
                           aei:type="SEQUENCE"
                           bpmnElement="144039208093112435"
                           isHorizontal="true">
            <dc:Bounds height="-1" width="-1" x="131" y="126"/>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:absoluteLocation="LOC {151,350}"
                           aei:absoluteSize="DIM {70,60}"
                           aei:attachments=""
                           aei:name="subscriptionWS"
                           aei:objectId="144039208092912431"
                           aei:principal=""
                           aei:text="subscriptionWS"
                           aei:type="RECEIVE"
                           bpmnElement="144039208092912431">
            <dc:Bounds height="-1" width="-1" x="0" y="0"/>
            <bpmndi:BPMNLabel aei:absoluteLocation="LOC {160,407}"
                              aei:absoluteSize="DIM {73,13}"
                              aei:anchor.location="1"
                              aei:anchor.objectId="144039208092912431"
                              aei:backgroundColor="RGB {255,255,255}"
                              aei:objectId="144039208093412437"
                              aei:relative.location="LOC {-36,47}"
                              aei:text="subscriptionWS"
                              bpmnElement="144039208092912431label">
               <dc:Bounds height="-1" width="-1" x="0" y="0"/>
            </bpmndi:BPMNLabel>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:absoluteLocation="LOC {246,350}"
                           aei:absoluteSize="DIM {70,60}"
                           aei:name="subscriptionWS-Reply"
                           aei:objectId="144039208093112433"
                           aei:text="subscriptionWS-Reply"
                           aei:type="REPLY"
                           bpmnElement="144039208093112433">
            <dc:Bounds height="-1" width="-1" x="0" y="0"/>
            <bpmndi:BPMNLabel aei:absoluteLocation="LOC {239,407}"
                              aei:absoluteSize="DIM {104,13}"
                              aei:anchor.location="1"
                              aei:anchor.objectId="144039208093112433"
                              aei:backgroundColor="RGB {255,255,255}"
                              aei:objectId="144039208093412439"
                              aei:relative.location="LOC {-52,47}"
                              aei:text="subscriptionWS-Reply"
                              bpmnElement="144039208093112433label">
               <dc:Bounds height="-1" width="-1" x="0" y="0"/>
            </bpmndi:BPMNLabel>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:absoluteLocation="LOC {341,146}"
                           aei:absoluteSize="DIM {1743,468}"
                           aei:objectId="144039219231015813"
                           aei:showFaultHandler="true"
                           aei:showTerminationHandler="false"
                           aei:type="SCOPE"
                           bpmnElement="144039219231015813"
                           isHorizontal="true">
            <dc:Bounds height="100" width="85" x="0" y="0"/>
            <bpmndi:BPMNLabel aei:absoluteLocation="LOC {1222,161}"
                              aei:absoluteSize="DIM {0,13}"
                              aei:anchor.location="11"
                              aei:anchor.objectId="144039219231015813"
                              aei:backgroundColor="RGB {255,255,255}"
                              aei:objectId="144039219231215831"
                              aei:relative.location="LOC {0,5}"
                              bpmnElement="144039219231015813label">
               <dc:Bounds height="-1" width="-1" x="0" y="0"/>
            </bpmndi:BPMNLabel>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:backgroundImageLocation="icons/bpmn/activity/ActivityBlock.png"
                           aei:objectId="144053717936423084"
                           aei:type="PARTNER_LINK"
                           aei:visible="false,false,false,false,false,"
                           bpmnElement="144053717936423084"/>
         <bpmndi:BPMNShape aei:absoluteLocation="LOC {506,198}"
                           aei:absoluteSize="DIM {1573,381}"
                           aei:objectId="144039219231215833"
                           aei:type="SEQUENCE"
                           bpmnElement="144039219231215833"
                           isHorizontal="true">
            <dc:Bounds height="-1" width="-1" x="160" y="47"/>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:absoluteLocation="LOC {516,362}"
                           aei:absoluteSize="DIM {125,53}"
                           aei:name="LoadConfiguraion"
                           aei:objectId="144039221030216273"
                           aei:type="ASSIGN"
                           bpmnElement="144039221030216273">
            <dc:Bounds height="-1" width="-1" x="0" y="0"/>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:absoluteLocation="LOC {666,362}"
                           aei:absoluteSize="DIM {125,53}"
                           aei:attachments="&lt;AttachmentRoot attachmentType=&#34;1&#34;&gt;&lt;AttachmentData location=&#34;C:\SunPower\ProjDocs\EDICom\546 15Q2 EDICOM Sequoia\546 15Q2 EDICOM Sequoia\204\EDI_204.xml&#34;&gt;&lt;Property property=&#34;Content-Type&#34; value=&#34;text/xml&#34;/&gt;&lt;Property property=&#34;Content-Location&#34; value=&#34;EDI_204.xml&#34;/&gt;&lt;Property property=&#34;X-Size&#34; value=&#34;5148&#34;/&gt;&lt;/AttachmentData&gt;&lt;/AttachmentRoot&gt;"
                           aei:name="subscriptionWS"
                           aei:objectId="144039263948618697"
                           aei:subprocessPath=""
                           aei:text="subscriptionWS"
                           aei:type="INVOKE"
                           bpmnElement="144039263948618697">
            <dc:Bounds height="-1" width="-1" x="493" y="127"/>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:absoluteLocation="LOC {816,208}"
                           aei:absoluteSize="DIM {1253,361}"
                           aei:objectId="158679830080420385"
                           aei:type="IF"
                           bpmnElement="158679830080420385"
                           isHorizontal="false">
            <dc:Bounds height="-1" width="-1" x="0" y="0"/>
            <bpmndi:BPMNLabel aei:absoluteLocation="LOC {867,364}"
                              aei:absoluteSize="DIM {8,13}"
                              aei:anchor.location="4"
                              aei:anchor.objectId="158679830080420385"
                              aei:backgroundColor="RGB {255,255,255}"
                              aei:objectId="158679830080520387"
                              aei:relative.location="LOC {6,-18}"
                              aei:text="If"
                              bpmnElement="158679830080420385label">
               <dc:Bounds height="-1" width="-1" x="0" y="0"/>
            </bpmndi:BPMNLabel>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:IF_EXPRESSION="count($gSubscriptionWSResponse/return)&gt;0"
                           aei:IF_EXPR_LANG="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"
                           aei:absoluteLocation="LOC {886,208}"
                           aei:absoluteSize="DIM {1123,265}"
                           aei:objectId="158679830080520389"
                           aei:type="ELSE_IF"
                           bpmnElement="158679830080420385ifDef">
            <dc:Bounds height="-1" width="-1" x="0" y="0"/>
            <bpmndi:BPMNLabel aei:absoluteLocation="LOC {887,337}"
                              aei:absoluteSize="DIM {56,13}"
                              aei:anchor.location="4"
                              aei:anchor.objectId="158679830080520389"
                              aei:backgroundColor="RGB {255,255,255}"
                              aei:objectId="158679830080520391"
                              aei:relative.location="LOC {-28,-13}"
                              aei:text="If Condition"
                              bpmnElement="158679830080420385ifDeflabel">
               <dc:Bounds height="-1" width="-1" x="0" y="0"/>
            </bpmndi:BPMNLabel>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:absoluteLocation="LOC {925,227}"
                           aei:absoluteSize="DIM {1084,227}"
                           aei:objectId="158679830080520393"
                           aei:type="SEQUENCE"
                           bpmnElement="158679830080520393"
                           isHorizontal="true">
            <dc:Bounds height="-1" width="-1" x="0" y="0"/>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:absoluteLocation="LOC {935,237}"
                           aei:absoluteSize="DIM {764,207}"
                           aei:name="If Messages Exists"
                           aei:objectId="144039274060420803"
                           aei:type="IF"
                           bpmnElement="144039274060420803"
                           isHorizontal="false">
            <dc:Bounds height="-1" width="-1" x="0" y="0"/>
            <bpmndi:BPMNLabel aei:absoluteLocation="LOC {986,316}"
                              aei:absoluteSize="DIM {89,13}"
                              aei:anchor.location="4"
                              aei:anchor.objectId="144039274060420803"
                              aei:backgroundColor="RGB {255,255,255}"
                              aei:objectId="144039274060520805"
                              aei:relative.location="LOC {6,-18}"
                              aei:text="If Messages Exists"
                              bpmnElement="144039274060420803label">
               <dc:Bounds height="-1" width="-1" x="0" y="0"/>
            </bpmndi:BPMNLabel>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:IF_EXPRESSION="count( $gSubscriptionWSResponse/return/messages)&gt;0"
                           aei:IF_EXPR_LANG="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"
                           aei:absoluteLocation="LOC {1005,237}"
                           aei:absoluteSize="DIM {634,111}"
                           aei:objectId="144039274060520807"
                           aei:type="ELSE_IF"
                           bpmnElement="144039274060420803ifDef">
            <dc:Bounds height="-1" width="-1" x="0" y="0"/>
            <bpmndi:BPMNLabel aei:absoluteLocation="LOC {1006,289}"
                              aei:absoluteSize="DIM {56,13}"
                              aei:anchor.location="4"
                              aei:anchor.objectId="144039274060520807"
                              aei:backgroundColor="RGB {255,255,255}"
                              aei:objectId="144039274060520809"
                              aei:relative.location="LOC {-28,-13}"
                              aei:text="If Condition"
                              bpmnElement="144039274060420803ifDeflabel">
               <dc:Bounds height="-1" width="-1" x="0" y="0"/>
            </bpmndi:BPMNLabel>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:absoluteLocation="LOC {1044,256}"
                           aei:absoluteSize="DIM {595,73}"
                           aei:objectId="144039274060520811"
                           aei:type="SEQUENCE"
                           bpmnElement="144039274060520811"
                           isHorizontal="true">
            <dc:Bounds height="-1" width="-1" x="0" y="0"/>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:absoluteLocation="LOC {1054,266}"
                           aei:absoluteSize="DIM {125,53}"
                           aei:name="Set Process Title"
                           aei:objectId="144044220287133245"
                           aei:type="ASSIGN"
                           bpmnElement="144044220287133245">
            <dc:Bounds height="-1" width="-1" x="0" y="0"/>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:absoluteLocation="LOC {1204,266}"
                           aei:absoluteSize="DIM {125,53}"
                           aei:name="Prepare CSV To XML Data"
                           aei:objectId="144043082183931135"
                           aei:type="ASSIGN"
                           bpmnElement="144043082183931135">
            <dc:Bounds height="-1" width="-1" x="0" y="0"/>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:absoluteLocation="LOC {1354,266}"
                           aei:absoluteSize="DIM {125,53}"
                           aei:attachments=""
                           aei:name="InsertData"
                           aei:objectId="158797812366456667"
                           aei:subprocessPath=""
                           aei:type="INVOKE"
                           bpmnElement="158797812366456667">
            <dc:Bounds height="-1" width="-1" x="0" y="0"/>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:absoluteLocation="LOC {1504,266}"
                           aei:absoluteSize="DIM {125,53}"
                           aei:attachments=""
                           aei:name="insertPayLoad"
                           aei:objectId="144042794480729225"
                           aei:subprocessPath=""
                           aei:text="execSQL"
                           aei:type="INVOKE"
                           bpmnElement="144042794480729225">
            <dc:Bounds height="-1" width="-1" x="460" y="151"/>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:absoluteLocation="LOC {1005,373}"
                           aei:absoluteSize="DIM {634,71}"
                           aei:objectId="144039274060620813"
                           aei:type="ELSE"
                           bpmnElement="144039274060420803elseDef">
            <dc:Bounds height="-1" width="-1" x="0" y="0"/>
            <bpmndi:BPMNLabel aei:absoluteLocation="LOC {1025,405}"
                              aei:absoluteSize="DIM {19,13}"
                              aei:anchor.location="4"
                              aei:anchor.objectId="144039274060620813"
                              aei:backgroundColor="RGB {255,255,255}"
                              aei:objectId="144039274060720815"
                              aei:relative.location="LOC {-9,-13}"
                              aei:text="Else"
                              bpmnElement="144039274060420803elseDeflabel">
               <dc:Bounds height="-1" width="-1" x="0" y="0"/>
            </bpmndi:BPMNLabel>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:absoluteLocation="LOC {1044,392}"
                           aei:absoluteSize="DIM {21,33}"
                           aei:objectId="144039274060720817"
                           aei:type="SEQUENCE"
                           bpmnElement="144039274060720817"
                           isHorizontal="true">
            <dc:Bounds height="-1" width="-1" x="0" y="0"/>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:absoluteLocation="LOC {1724,314}"
                           aei:absoluteSize="DIM {125,53}"
                           aei:attachments=""
                           aei:name="confirmSubscriptionWS"
                           aei:objectId="144044362568846247"
                           aei:subprocessPath=""
                           aei:text="confirmSubscriptionWS"
                           aei:type="INVOKE"
                           bpmnElement="144044362568846247">
            <dc:Bounds height="-1" width="-1" x="470" y="23"/>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:absoluteLocation="LOC {1874,314}"
                           aei:absoluteSize="DIM {125,53}"
                           aei:attachments=""
                           aei:name="ProcessEdicom_File"
                           aei:objectId="144044499618454339"
                           aei:subprocessPath=""
                           aei:type="INVOKE"
                           bpmnElement="144044499618454339">
            <dc:Bounds height="-1" width="-1" x="0" y="0"/>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:absoluteLocation="LOC {886,498}"
                           aei:absoluteSize="DIM {1123,71}"
                           aei:objectId="158679830080620395"
                           aei:type="ELSE"
                           bpmnElement="158679830080420385elseDef">
            <dc:Bounds height="-1" width="-1" x="0" y="0"/>
            <bpmndi:BPMNLabel aei:absoluteLocation="LOC {906,530}"
                              aei:absoluteSize="DIM {19,13}"
                              aei:anchor.location="4"
                              aei:anchor.objectId="158679830080620395"
                              aei:backgroundColor="RGB {255,255,255}"
                              aei:objectId="158679830080620397"
                              aei:relative.location="LOC {-9,-13}"
                              aei:text="Else"
                              bpmnElement="158679830080420385elseDeflabel">
               <dc:Bounds height="-1" width="-1" x="0" y="0"/>
            </bpmndi:BPMNLabel>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:absoluteLocation="LOC {925,517}"
                           aei:absoluteSize="DIM {21,33}"
                           aei:objectId="158679830080620399"
                           aei:type="SEQUENCE"
                           bpmnElement="158679830080620399"
                           isHorizontal="true">
            <dc:Bounds height="-1" width="-1" x="0" y="0"/>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:absoluteLocation="LOC {679,555}"
                           aei:absoluteSize="DIM {125,53}"
                           aei:catchAllFaults="false"
                           aei:catchFaultName="data-access:dataAccessFault faultType=1"
                           aei:collapedImageLocation="icons/bpmn/activity/blocks/collapsed/handlers/CollapsedHandlerBlockGreen.png"
                           aei:expanded="false"
                           aei:expandedSize="DIM {235,93}"
                           aei:objectId="144053717936423066"
                           aei:text="Catch DAS"
                           aei:type="CATCH"
                           bpmnElement="144053717936423066"
                           isHorizontal="true">
            <dc:Bounds height="-1" width="-1" x="333" y="404"/>
            <bpmndi:BPMNLabel aei:anchor.location="0"
                              aei:anchor.objectId="143758705763873449"
                              aei:backgroundColor="RGB {255,255,255}"
                              aei:objectId="144053717936423071"
                              aei:relative.location="LOC {-12,0}"
                              aei:text="Catch DAS"
                              bpmnElement="144053717936423066label">
               <dc:Bounds height="-1" width="-1" x="0" y="0"/>
            </bpmndi:BPMNLabel>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:objectId="144053717936423067"
                           aei:type="SEQUENCE"
                           bpmnElement="144053717936423067"
                           isHorizontal="true">
            <dc:Bounds height="-1" width="-1" x="420" y="123"/>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:name="TxnAudit"
                           aei:objectId="144053717936423068"
                           aei:subprocessPath=""
                           aei:text="TxnAudit"
                           aei:type="INVOKE"
                           bpmnElement="144053717936423068">
            <dc:Bounds height="-1" width="-1" x="430" y="133"/>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:backgroundImageLocation="icons/bpmn/activity/ActivityBlock.png"
                           aei:name="Throw Scheduler Fault"
                           aei:objectId="144053717936423069"
                           aei:type="THROW"
                           bpmnElement="144053717936423069">
            <dc:Bounds height="-1" width="-1" x="10" y="10"/>
            <bpmndi:BPMNLabel aei:anchor.location="1"
                              aei:anchor.objectId="1437694768280148210"
                              aei:backgroundColor="RGB {255,255,255}"
                              aei:objectId="144053717936423070"
                              aei:relative.location="LOC {-12,47}"
                              aei:text="Throw Scheduler Fault"
                              bpmnElement="144053717936423069label">
               <dc:Bounds height="-1" width="-1" x="0" y="0"/>
            </bpmndi:BPMNLabel>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:absoluteLocation="LOC {440,401}"
                           aei:absoluteSize="DIM {125,53}"
                           aei:catchAllFaults="false"
                           aei:catchFaultName="EBIBrokerWebServiceV2:EBIBrokerServerException faultType=1"
                           aei:collapedImageLocation="icons/bpmn/activity/blocks/collapsed/handlers/CollapsedHandlerBlockOrange.png"
                           aei:expanded="false"
                           aei:expandedSize="DIM {235,93}"
                           aei:objectId="144053717936423072"
                           aei:text="Catch Broker Exception"
                           aei:type="CATCH"
                           bpmnElement="144053717936423072"
                           isHorizontal="true">
            <dc:Bounds height="-1" width="-1" x="94" y="250"/>
            <bpmndi:BPMNLabel aei:anchor.location="0"
                              aei:anchor.objectId="143758705763873449"
                              aei:backgroundColor="RGB {255,255,255}"
                              aei:objectId="144053717936423077"
                              aei:relative.location="LOC {-12,0}"
                              aei:text="Catch Broker Exception"
                              bpmnElement="144053717936423072label">
               <dc:Bounds height="-1" width="-1" x="0" y="0"/>
            </bpmndi:BPMNLabel>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:objectId="144053717936423073"
                           aei:type="SEQUENCE"
                           bpmnElement="144053717936423073"
                           isHorizontal="true">
            <dc:Bounds height="-1" width="-1" x="420" y="123"/>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:name="TxnAudit"
                           aei:objectId="144053717936423074"
                           aei:subprocessPath=""
                           aei:text="TxnAudit"
                           aei:type="INVOKE"
                           bpmnElement="144053717936423074">
            <dc:Bounds height="-1" width="-1" x="430" y="133"/>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:backgroundImageLocation="icons/bpmn/activity/ActivityBlock.png"
                           aei:name="Throw Scheduler Fault"
                           aei:objectId="144053717936423075"
                           aei:type="THROW"
                           bpmnElement="144053717936423075">
            <dc:Bounds height="-1" width="-1" x="20" y="20"/>
            <bpmndi:BPMNLabel aei:absoluteSize="DIM {0,0}"
                              aei:anchor.location="1"
                              aei:anchor.objectId="1437694768280148210"
                              aei:backgroundColor="RGB {255,255,255}"
                              aei:objectId="144053717936423076"
                              aei:relative.location="LOC {-12,47}"
                              aei:text="Throw Scheduler Fault"
                              bpmnElement="144053717936423075label">
               <dc:Bounds height="-1" width="-1" x="0" y="0"/>
            </bpmndi:BPMNLabel>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:absoluteLocation="LOC {349,419}"
                           aei:absoluteSize="DIM {125,53}"
                           aei:catchAllFaults="true"
                           aei:collapedIconLocation="icons/bpmn/activity/catch.png"
                           aei:collapedImageLocation="icons/bpmn/activity/blocks/collapsed/handlers/CollapsedHandlerBlockBlue.png"
                           aei:constraint=""
                           aei:expanded="false"
                           aei:expandedSize="DIM {235,93}"
                           aei:imageLocation="icons/bpmn/activity/large/paletteCatchLarge.png"
                           aei:objectId="144053717936423060"
                           aei:text="Catch All"
                           aei:type="CATCH_ALL"
                           bpmnElement="144053717936423060"
                           isHorizontal="true">
            <dc:Bounds height="-1" width="-1" x="3" y="268"/>
            <bpmndi:BPMNLabel aei:anchor.location="0"
                              aei:anchor.objectId="143758706488373803"
                              aei:backgroundColor="RGB {255,255,255}"
                              aei:objectId="144053717936423065"
                              aei:relative.location="LOC {-12,0}"
                              aei:text="Catch All"
                              bpmnElement="144053717936423060label">
               <dc:Bounds height="-1" width="-1" x="0" y="0"/>
            </bpmndi:BPMNLabel>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:name="TxnAudit"
                           aei:objectId="144053717936423062"
                           aei:subprocessPath=""
                           aei:text="TxnAudit"
                           aei:type="INVOKE"
                           bpmnElement="144053717936423062">
            <dc:Bounds height="-1" width="-1" x="181" y="131"/>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:actySimState="0"
                           aei:bpelName=""
                           aei:joinConditionComp=""
                           aei:objectId="144053717936423061"
                           aei:type="Sequence"
                           bpmnElement="144053717936423062wrappingSequence"
                           isHorizontal="true">
            <dc:Bounds height="-1" width="-1" x="171" y="121"/>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:catchAllFaults="false"
                           aei:catchFaultName="SchedulerFault faultType=3"
                           aei:collapedImageLocation="icons/bpmn/activity/blocks/collapsed/handlers/CollapsedHandlerBlockBlue.png"
                           aei:expanded="false"
                           aei:expandedSize="DIM {235,93}"
                           aei:objectId="144053749225533584"
                           aei:text="Error SchedulerFault"
                           aei:type="CATCH"
                           bpmnElement="144053749225533584"
                           isHorizontal="true">
            <dc:Bounds height="-1" width="-1" x="135" y="70"/>
            <bpmndi:BPMNLabel aei:anchor.location="0"
                              aei:anchor.objectId="1437694726609143278"
                              aei:backgroundColor="RGB {255,255,255}"
                              aei:objectId="144053749225533587"
                              aei:relative.location="LOC {-12,0}"
                              aei:text="Error"
                              bpmnElement="144053749225533584label">
               <dc:Bounds height="-1" width="-1" x="0" y="0"/>
            </bpmndi:BPMNLabel>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:attachments=""
                           aei:name="ProcessEdicom_File"
                           aei:objectId="144053749225533586"
                           aei:subprocessPath=""
                           aei:text="subscriptionWS"
                           aei:type="INVOKE"
                           bpmnElement="144053749225533586">
            <dc:Bounds height="53" width="125" x="0" y="0"/>
         </bpmndi:BPMNShape>
         <bpmndi:BPMNShape aei:actySimState="0"
                           aei:bpelName=""
                           aei:joinConditionComp=""
                           aei:objectId="144053749225533585"
                           aei:type="Sequence"
                           bpmnElement="144053749225533586wrappingSequence"
                           isHorizontal="true">
            <dc:Bounds height="-1" width="-1" x="-10" y="-10"/>
         </bpmndi:BPMNShape>
      </bpmndi:BPMNPlane>
   </bpmndi:BPMNDiagram>
   <bpel:extensions>
      <bpel:extension mustUnderstand="no"
                      namespace="http://www.activebpel.org/2009/02/bpel/extension/ignorable"/>
      <bpel:extension mustUnderstand="no"
                      namespace="http://www.omg.org/spec/BPMN/20100524/DI"/>
      <bpel:extension mustUnderstand="yes"
                      namespace="http://www.activebpel.org/2006/09/bpel/extension/query_handling"/>
      <bpel:extension mustUnderstand="yes"
                      namespace="http://www.activebpel.org/2009/06/bpel/extension/links"/>
      <bpel:extension mustUnderstand="yes"
                      namespace="http://www.activebpel.org/2011/08/bpel/extension/script"/>
   </bpel:extensions>
   <bpel:import importType="http://schemas.xmlsoap.org/wsdl/"
                location="../../Edicom_Common/wsdl/Edicom_PLT.wsdl"
                namespace="http://www.sunpower.com/middleware/realtime/PLT/wsdl/1.0"/>
   <bpel:import importType="http://schemas.xmlsoap.org/wsdl/"
                location="../../Edicom_Common/wsdl/EBIBrokerWebServiceV2.wsdl"
                namespace="http://com.edicom.broker.adapter.services"/>
   <bpel:import importType="http://schemas.xmlsoap.org/wsdl/"
                namespace="http://docs.active-endpoints/wsdl/data-access/2010/04/data-access.wsdl"/>
   <bpel:import importType="http://modules.active-endpoints.com/2009/07/xquery"
                location="../xquery/Edicom_Agent.xq"
                namespace="http://www.sunpower.com/middleware/realtime/edicom_soa/xquery/1.0"/>
   <bpel:import importType="http://schemas.xmlsoap.org/wsdl/"
                location="../../SunPower_Agent/wsdl/bpel/Txn_Audit.public.wsdl"
                namespace="http://Txn_Audit/txn_audit/public"/>
   <bpel:import importType="http://schemas.xmlsoap.org/wsdl/"
                location="../../SunPower_Common/wsdl/txn-audit.wsdl"
                namespace="http://www.sunpower.com/middleware/realtime/txn-audit/wsdl/1.0"/>
   <bpel:import importType="http://schemas.xmlsoap.org/wsdl/"
                location="../wsdl/bpel/ProcessEdicom_947.public.wsdl"
                namespace="http://ProcessEdicomFiles/processedicomfiles/public"/>
   <bpel:import importType="http://www.w3.org/2001/XMLSchema"
                location="../../SunPower_Common/schema/data-access.xsd"
                namespace="http://schemas.active-endpoints.com/data-access/2010/04/data-access.xsd"/>
   <bpel:import importType="http://modules.active-endpoints.com/2009/07/xquery"
                location="../xquery/CSVtoXMLConversion.xq"
                namespace="http://www.sunpower.com/middleware/realtime/sunpower/agent/csvtoxml/xquery/1.0"/>
   <bpel:partnerLinks>
      <bpel:partnerLink aei:id="144039203409512209"
                        myRole="Provider"
                        name="Process_Consumer"
                        partnerLinkType="Edicom_PLT:EBIBrokerV2PLT"/>
      <bpel:partnerLink aei:id="144039261505318531"
                        name="Edicom_PLT"
                        partnerLinkType="Edicom_PLT:EBIBrokerV2PLT"
                        partnerRole="Provider"/>
      <bpel:partnerLink aei:id="144042792157028151"
                        name="DAS_PLT"
                        partnerLinkType="data-access:dataAccessPLT"
                        partnerRole="sender"/>
      <bpel:partnerLink aei:id="144044505385655211"
                        name="ProcessEdicom_PLT"
                        partnerLinkType="Edicom_PLT:EBIBrokerV2PLT"
                        partnerRole="Provider"/>
   </bpel:partnerLinks>
   <bpel:variables>
      <bpel:variable name="gConfiguration" type="xsd:anyType"/>
      <bpel:variable element="EBIBrokerWebServiceV2:subscriptionWS" name="gSubscriptionWS"/>
      <bpel:variable element="EBIBrokerWebServiceV2:subscriptionWSResponse"
                     name="gSubscriptionWSResponse"/>
      <bpel:variable name="gEdicom997" type="xsd:anyType"/>
      <bpel:variable name="gFileName" type="xsd:string"/>
      <bpel:variable element="das:dataAccessResponse" name="gDataAccessResponse_Payload"/>
      <bpel:variable element="das:dataAccessResponse" name="dataAccessResponse"/>
      <bpel:variable element="das:multiDataAccessResponse" name="multiDataAccessResponse"/>
      <bpel:variable element="EBIBrokerWebServiceV2:confirmSubscriptionWSResponse"
                     name="confirmSubscriptionWSResponse"/>
      <bpel:variable name="gEDI997XML" type="xsd:anyType"/>
   </bpel:variables>
   <bpel:faultHandlers>
      <bpel:catch aei:id="144053749225533584" faultName="SchedulerFault">
         <bpel:invoke aei:id="144053749225533586"
                      inputVariable="gSubscriptionWS"
                      name="ProcessEdicom_File"
                      operation="subscriptionWS"
                      outputVariable="gSubscriptionWSResponse"
                      partnerLink="ProcessEdicom_PLT"/>
      </bpel:catch>
   </bpel:faultHandlers>
   <bpel:sequence aei:id="144039208093112435">
      <bpel:receive aei:id="144039208092912431"
                    createInstance="yes"
                    name="subscriptionWS"
                    operation="subscriptionWS"
                    partnerLink="Process_Consumer"
                    variable="gSubscriptionWS"/>
      <bpel:scope aei:implicit="true" name="subscriptionWS-Reply">
         <bpel:variables>
            <bpel:variable messageType="EBIBrokerWebServiceV2:subscriptionWSResponse"
                           name="parameters"/>
         </bpel:variables>
         <bpel:sequence>
            <bpel:assign aei:assignType="XQUERY" aei:id="144039241205817555">
               <bpel:copy>
                  <bpel:from expressionLanguage="urn:active-endpoints:expression-language:xquery1.0">&lt;EBIBrokerWebServiceV2:subscriptionWSResponse xmlns:EBIBrokerWebServiceV2="http://com.edicom.broker.adapter.services"&gt;
&lt;/EBIBrokerWebServiceV2:subscriptionWSResponse&gt;</bpel:from>
                  <bpel:to part="parameters" variable="parameters"/>
               </bpel:copy>
            </bpel:assign>
            <bpel:reply aei:id="144039208093112433"
                        name="subscriptionWS-Reply"
                        operation="subscriptionWS"
                        partnerLink="Process_Consumer"
                        variable="parameters"/>
         </bpel:sequence>
      </bpel:scope>
      <bpel:scope aei:id="144039219231015813">
         <bpel:partnerLinks>
            <bpel:partnerLink aei:id="144053717936423084"
                              name="Audit_PLT"
                              partnerLinkType="Txn_Audit.public:TxnAuditPortTypePLT"
                              partnerRole="Provider"/>
         </bpel:partnerLinks>
         <bpel:faultHandlers>
            <bpel:catch aei:id="144053717936423066"
                        faultMessageType="data-access:dataAccessFaultMessage"
                        faultName="data-access:dataAccessFault"
                        faultVariable="dataAccessMessage">
               <bpel:sequence aei:id="144053717936423067">
                  <bpel:scope aei:implicit="true" name="TxnAudit">
                     <bpel:variables>
                        <bpel:variable messageType="txn-audit:TxnAuditRequestMessage" name="parameters"/>
                     </bpel:variables>
                     <bpel:sequence>
                        <bpel:assign aei:assignType="XQUERY" aei:id="143758712202878569">
                           <bpel:copy>
                              <bpel:from expressionLanguage="urn:active-endpoints:expression-language:xquery1.0">&lt;ns:TxnAuditRequest xmlns:ns="http://www.sunpower.com/middleware/realtime/txn-audit/schema/1.0"&gt;&lt;!--Optional:--&gt;
   &lt;LOG_MESSAGE&gt;{ $dataAccessMessage.faultPart/das:errorMessage/text() }&lt;/LOG_MESSAGE&gt;
   &lt;SYSTEM_TYPE&gt;ICRT&lt;/SYSTEM_TYPE&gt;
   &lt;EXCEPTION_TYPE&gt;SYSTEM_FAULT&lt;/EXCEPTION_TYPE&gt;
   &lt;GLOBAL_MESSAGE_ID&gt;&lt;/GLOBAL_MESSAGE_ID&gt;
   &lt;INTERFACE_NAME&gt;ProcessEdicom_204&lt;/INTERFACE_NAME&gt;
   &lt;INTERFACE_NO&gt;EDI204_AGT&lt;/INTERFACE_NO&gt;
   &lt;PROCESS_ID&gt;{ abx:getProcessId() }&lt;/PROCESS_ID&gt;
   &lt;PARENT_PROCESS_ID&gt;&lt;/PARENT_PROCESS_ID&gt;
   &lt;SOURCE_SYSTEM_ID&gt;EDICOM&lt;/SOURCE_SYSTEM_ID&gt;
   &lt;DESTINATION_SYSTEM_ID&gt;ORACLE&lt;/DESTINATION_SYSTEM_ID&gt;
   &lt;SEVERITY&gt;3&lt;/SEVERITY&gt;
   &lt;CREATION_TIMESTAMP&gt;&lt;/CREATION_TIMESTAMP&gt;
   &lt;STACK_TRACE&gt;{ abx:elementToXMLString( abx:getFaultDetail() ) }&lt;/STACK_TRACE&gt;
   &lt;TRANSACTION_DATA&gt;{ $gEdicom997/* }&lt;/TRANSACTION_DATA&gt;
   &lt;ERROR_SOURCE&gt;ORACLE&lt;/ERROR_SOURCE&gt;
   &lt;ERROR_CODE&gt;{ data($dataAccessMessage.faultPart/@sqlcode) }&lt;/ERROR_CODE&gt;
   &lt;NOTIFICATION_SENT&gt;&lt;/NOTIFICATION_SENT&gt;
   &lt;ATTRIBUTE1&gt;&lt;/ATTRIBUTE1&gt;
   &lt;ATTRIBUTE2&gt;&lt;/ATTRIBUTE2&gt;
   &lt;FILE_NAME&gt;{ $gSubscriptionWSResponse/return/messages[1]/name/text()  }&lt;/FILE_NAME&gt;
&lt;/ns:TxnAuditRequest&gt;</bpel:from>
                              <bpel:to part="in" variable="parameters"/>
                           </bpel:copy>
                        </bpel:assign>
                        <bpel:invoke aei:id="144053717936423068"
                                     inputVariable="parameters"
                                     name="TxnAudit"
                                     operation="TxnAudit"
                                     outputVariable="dataAccessMessage"
                                     partnerLink="Audit_PLT"/>
                     </bpel:sequence>
                  </bpel:scope>
                  <bpel:throw aei:id="144053717936423069"
                              faultName="SchedulerFault"
                              name="Throw_Scheduler_Fault"/>
               </bpel:sequence>
            </bpel:catch>
            <bpel:catch aei:id="144053717936423072"
                        faultMessageType="EBIBrokerWebServiceV2:EBIBrokerServerException"
                        faultName="EBIBrokerWebServiceV2:EBIBrokerServerException"
                        faultVariable="brokerException">
               <bpel:sequence aei:id="144053717936423073">
                  <bpel:scope aei:implicit="true" name="TxnAudit">
                     <bpel:variables>
                        <bpel:variable messageType="txn-audit:TxnAuditRequestMessage" name="parameters"/>
                     </bpel:variables>
                     <bpel:sequence>
                        <bpel:assign aei:assignType="XQUERY" aei:id="143758712202878569">
                           <bpel:copy>
                              <bpel:from expressionLanguage="urn:active-endpoints:expression-language:xquery1.0">let $payload := if (abx:isVariableInitialized('$gEDI997XML'))
                   then $gEDI997XML
                else
                    ''
let $errorCode := $brokerException.EBIBrokerServerException/number/text()
let $response-mapping := $gConfiguration/edicom-response-mapping
let $message := data($response-mapping/parameter[@number=$errorCode]/@message)

return 

&lt;ns:TxnAuditRequest xmlns:ns="http://www.sunpower.com/middleware/realtime/txn-audit/schema/1.0"&gt;&lt;!--Optional:--&gt;
   &lt;LOG_MESSAGE&gt;{ $message }&lt;/LOG_MESSAGE&gt;
   &lt;SYSTEM_TYPE&gt;ORACLE&lt;/SYSTEM_TYPE&gt;
   &lt;EXCEPTION_TYPE&gt;SYSTEM_FAULT&lt;/EXCEPTION_TYPE&gt;
   &lt;GLOBAL_MESSAGE_ID&gt;&lt;/GLOBAL_MESSAGE_ID&gt;
   &lt;INTERFACE_NAME&gt;ProcessEdicom_997&lt;/INTERFACE_NAME&gt;
   &lt;INTERFACE_NO&gt;EDI997_AGT&lt;/INTERFACE_NO&gt;
   &lt;PROCESS_ID&gt;{ abx:getProcessId() }&lt;/PROCESS_ID&gt;
   &lt;PARENT_PROCESS_ID&gt;&lt;/PARENT_PROCESS_ID&gt;
   &lt;SOURCE_SYSTEM_ID&gt;EDICOM&lt;/SOURCE_SYSTEM_ID&gt;
   &lt;DESTINATION_SYSTEM_ID&gt;ORACLE&lt;/DESTINATION_SYSTEM_ID&gt;
   &lt;SEVERITY&gt;2&lt;/SEVERITY&gt;
   &lt;CREATION_TIMESTAMP&gt;&lt;/CREATION_TIMESTAMP&gt;
   &lt;STACK_TRACE&gt; {$gEDI997XML }&lt;/STACK_TRACE&gt;
   &lt;TRANSACTION_DATA&gt;{ $gEDI997XML }&lt;/TRANSACTION_DATA&gt;
   &lt;ERROR_SOURCE&gt;EDICOM&lt;/ERROR_SOURCE&gt;
   &lt;ERROR_CODE&gt;{ $errorCode}&lt;/ERROR_CODE&gt;
   &lt;NOTIFICATION_SENT&gt;&lt;/NOTIFICATION_SENT&gt;
   &lt;ATTRIBUTE1&gt;&lt;/ATTRIBUTE1&gt;
   &lt;ATTRIBUTE2&gt;&lt;/ATTRIBUTE2&gt;
&lt;/ns:TxnAuditRequest&gt;</bpel:from>
                              <bpel:to part="in" variable="parameters"/>
                           </bpel:copy>
                        </bpel:assign>
                        <bpel:invoke aei:id="144053717936423074"
                                     inputVariable="parameters"
                                     name="TxnAudit"
                                     operation="TxnAudit"
                                     partnerLink="Audit_PLT"/>
                     </bpel:sequence>
                  </bpel:scope>
                  <bpel:throw aei:id="144053717936423075"
                              faultName="SchedulerFault"
                              name="Throw_Scheduler_Fault"/>
               </bpel:sequence>
            </bpel:catch>
            <bpel:catchAll aei:id="144053717936423060">
               <bpel:scope aei:implicit="true" name="TxnAudit">
                  <bpel:variables>
                     <bpel:variable messageType="txn-audit:TxnAuditRequestMessage" name="parameters"/>
                  </bpel:variables>
                  <bpel:sequence>
                     <bpel:assign aei:assignType="XQUERY" aei:id="143758711332577319">
                        <bpel:copy>
                           <bpel:from expressionLanguage="urn:active-endpoints:expression-language:xquery1.0">let $payload := if (abx:isVariableInitialized('gEdicom997'))
                   then $gEdicom997
                else
                    ''
let $fileName :=if (abx:isVariableInitialized('gSubscriptionWSResponse'))
                   then $gSubscriptionWSResponse/return/messages[1]/name/text()
                else
                    ''
return 
&lt;ns:TxnAuditRequest xmlns:ns="http://www.sunpower.com/middleware/realtime/txn-audit/schema/1.0"&gt;&lt;!--Optional:--&gt;
   &lt;LOG_MESSAGE&gt;{ abx:getFaultString() }&lt;/LOG_MESSAGE&gt;
   &lt;SYSTEM_TYPE&gt;ICRT&lt;/SYSTEM_TYPE&gt;
   &lt;EXCEPTION_TYPE&gt;SYSTEM_FAULT&lt;/EXCEPTION_TYPE&gt;
   &lt;GLOBAL_MESSAGE_ID&gt;&lt;/GLOBAL_MESSAGE_ID&gt;
   &lt;INTERFACE_NAME&gt;ProcessEdicom_204&lt;/INTERFACE_NAME&gt;
   &lt;INTERFACE_NO&gt;EDI204_AGT&lt;/INTERFACE_NO&gt;
   &lt;PROCESS_ID&gt;{ abx:getProcessId() }&lt;/PROCESS_ID&gt;
   &lt;PARENT_PROCESS_ID&gt;&lt;/PARENT_PROCESS_ID&gt;
   &lt;SOURCE_SYSTEM_ID&gt;EDICOM&lt;/SOURCE_SYSTEM_ID&gt;
   &lt;DESTINATION_SYSTEM_ID&gt;ORACLE&lt;/DESTINATION_SYSTEM_ID&gt;
   &lt;SEVERITY&gt;1&lt;/SEVERITY&gt;
   &lt;CREATION_TIMESTAMP&gt;&lt;/CREATION_TIMESTAMP&gt;
   &lt;STACK_TRACE&gt;{ abx:elementToXMLString( abx:getFaultDetail() ) }&lt;/STACK_TRACE&gt;
   &lt;TRANSACTION_DATA&gt;{ $payload }&lt;/TRANSACTION_DATA&gt;
   &lt;ERROR_SOURCE&gt;ICRT&lt;/ERROR_SOURCE&gt;
   &lt;ERROR_CODE&gt;{ abx:getFaultCode() }&lt;/ERROR_CODE&gt;
   &lt;NOTIFICATION_SENT&gt;&lt;/NOTIFICATION_SENT&gt;
   &lt;ATTRIBUTE1&gt;&lt;/ATTRIBUTE1&gt;
   &lt;ATTRIBUTE2&gt;&lt;/ATTRIBUTE2&gt;
   &lt;FILE_NAME&gt;{$fileName  }&lt;/FILE_NAME&gt;
&lt;/ns:TxnAuditRequest&gt;</bpel:from>
                           <bpel:to part="in" variable="parameters"/>
                        </bpel:copy>
                     </bpel:assign>
                     <bpel:invoke aei:id="144053717936423062"
                                  inputVariable="parameters"
                                  name="TxnAudit"
                                  operation="TxnAudit"
                                  partnerLink="Audit_PLT"/>
                  </bpel:sequence>
               </bpel:scope>
            </bpel:catchAll>
         </bpel:faultHandlers>
         <bpel:sequence aei:id="144039219231215833">
            <bpel:assign aei:id="144039221030216273" name="LoadConfiguraion">
               <bpel:copy>
                  <bpel:from>abx:getCatalogResource('project:/EdicomAgent_SOA/config/gConfiguration_997.xml')</bpel:from>
                  <bpel:to variable="gConfiguration"/>
               </bpel:copy>
            </bpel:assign>
            <bpel:invoke aei:id="144039263948618697"
                         inputVariable="gSubscriptionWS"
                         name="subscriptionWS"
                         operation="subscriptionWS"
                         outputVariable="gSubscriptionWSResponse"
                         partnerLink="Edicom_PLT"/>
            <bpel:if aei:id="158679830080420385">
               <bpel:condition>count($gSubscriptionWSResponse/return)&gt;0</bpel:condition>
               <bpel:sequence aei:id="158679830080520393">
                  <bpel:if aei:id="144039274060420803" name="If_Messages_Exists">
                     <bpel:condition>count( $gSubscriptionWSResponse/return/messages)&gt;0</bpel:condition>
                     <bpel:sequence aei:id="144039274060520811">
                        <bpel:assign aei:id="144044220287133245" name="Set_Process_Title">
                           <bpel:copy>
                              <bpel:from>$gSubscriptionWSResponse/return/messages[1]/name/text()</bpel:from>
                              <bpel:to variable="gFileName"/>
                           </bpel:copy>
                           <bpel:extensionAssignOperation>
                              <ext2:script>abx:setProcessTitle( $gFileName )</ext2:script>
                           </bpel:extensionAssignOperation>
                        </bpel:assign>
                        <bpel:assign aei:id="144043082183931135" name="Prepare_CSV_To_XML_Data">
                           <bpel:copy>
                              <bpel:from>abx:base64Decode($gSubscriptionWSResponse/return/messages/message/text())</bpel:from>
                              <bpel:to variable="gEdicom997"/>
                           </bpel:copy>
                           <bpel:copy>
                              <bpel:from expressionLanguage="urn:active-endpoints:expression-language:xquery1.0">csvtoxml:convert997CSVtoXML($gEdicom997, &lt;EDI997/&gt;)</bpel:from>
                              <bpel:to variable="gEDI997XML"/>
                           </bpel:copy>
                        </bpel:assign>
                        <bpel:scope aei:implicit="true" name="InsertData">
                           <bpel:variables>
                              <bpel:variable messageType="data-access:multiDataAccessMessage" name="parameters"/>
                           </bpel:variables>
                           <bpel:sequence>
                              <bpel:assign aei:assignType="XQUERY" aei:id="158797845638559217">
                                 <bpel:copy>
                                    <bpel:from expressionLanguage="urn:active-endpoints:expression-language:xquery1.0">ediQ_SOA:prepareDASRequestForEdicom997( $gConfiguration, $gEDI997XML, $gFileName )</bpel:from>
                                    <bpel:to part="dataAccessPart" variable="parameters"/>
                                 </bpel:copy>
                              </bpel:assign>
                              <bpel:invoke aei:id="158797812366456667"
                                           inputVariable="parameters"
                                           name="InsertData"
                                           operation="execMultiSQL"
                                           outputVariable="multiDataAccessResponse"
                                           partnerLink="DAS_PLT"/>
                           </bpel:sequence>
                        </bpel:scope>
                        <bpel:scope aei:implicit="true" name="insertPayLoad">
                           <bpel:variables>
                              <bpel:variable messageType="data-access:dataAccessMessage" name="parameters"/>
                           </bpel:variables>
                           <bpel:sequence>
                              <bpel:assign aei:assignType="XQUERY" aei:id="144042801124029817">
                                 <bpel:copy>
                                    <bpel:from expressionLanguage="urn:active-endpoints:expression-language:xquery1.0">&lt;das:dataAccessRequest xmlns:das="http://schemas.active-endpoints.com/data-access/2010/04/data-access.xsd"&gt;
   &lt;das:sqlStatement columnCase="lowercase"
                     hasResultSet="false"
                     includeMetadata="false"
                     maxRows="0"
                     maxWaitSeconds="0"
                     statementId="Insert-Payload"&gt;
      &lt;das:statement&gt;INSERT INTO XXSPWR.XXSPWR_EDI_AUDIT_TABLE_STG (FILE_NAME,DATE_CREATED,PAYLOAD,SIGNAL_TYPE) VALUES (?,SYSDATE,?,'997')&lt;/das:statement&gt;
      &lt;das:parameter  sqlType="string"&gt;{ $gSubscriptionWSResponse/return/messages[1]/name/text() }&lt;/das:parameter&gt;
     &lt;das:parameter  sqlType="string"&gt;{ $gEDI997XML }&lt;/das:parameter&gt;      
&lt;/das:sqlStatement&gt;
&lt;/das:dataAccessRequest&gt;</bpel:from>
                                    <bpel:to part="dataAccessPart" variable="parameters"/>
                                 </bpel:copy>
                              </bpel:assign>
                              <bpel:invoke aei:id="144042794480729225"
                                           inputVariable="parameters"
                                           name="insertPayLoad"
                                           operation="execSQL"
                                           outputVariable="gDataAccessResponse_Payload"
                                           partnerLink="DAS_PLT"/>
                           </bpel:sequence>
                        </bpel:scope>
                     </bpel:sequence>
                     <bpel:else aei:id="144039274060620813">
                        <bpel:empty aei:id="144039274060720817" aei:implicit="yes"/>
                     </bpel:else>
                  </bpel:if>
                  <bpel:scope aei:implicit="true" name="confirmSubscriptionWS">
                     <bpel:variables>
                        <bpel:variable messageType="EBIBrokerWebServiceV2:confirmSubscriptionWS"
                                       name="parameters"/>
                     </bpel:variables>
                     <bpel:sequence>
                        <bpel:assign aei:assignType="XQUERY" aei:id="144044362918947049">
                           <bpel:copy>
                              <bpel:from expressionLanguage="urn:active-endpoints:expression-language:xquery1.0">&lt;EBIBrokerWebServiceV2:confirmSubscriptionWS xmlns:EBIBrokerWebServiceV2="http://com.edicom.broker.adapter.services"&gt;&lt;!--Optional:--&gt;
    &lt;clientId&gt;{ $gSubscriptionWS/clientId/text() }&lt;/clientId&gt;
   &lt;user&gt;{ $gSubscriptionWS/user/text() }&lt;/user&gt;
   &lt;password&gt;{ $gSubscriptionWS/password/text() }&lt;/password&gt;
   &lt;domain&gt;{ $gSubscriptionWS/domain/text() }&lt;/domain&gt;
   &lt;application&gt;{ $gSubscriptionWS/application/text() }&lt;/application&gt;
   &lt;messageIds&gt;{ $gSubscriptionWSResponse/return/id/text() }&lt;/messageIds&gt;
&lt;/EBIBrokerWebServiceV2:confirmSubscriptionWS&gt;</bpel:from>
                              <bpel:to part="parameters" variable="parameters"/>
                           </bpel:copy>
                        </bpel:assign>
                        <bpel:invoke aei:id="144044362568846247"
                                     inputVariable="parameters"
                                     name="confirmSubscriptionWS"
                                     operation="confirmSubscriptionWS"
                                     outputVariable="confirmSubscriptionWSResponse"
                                     partnerLink="Edicom_PLT"/>
                     </bpel:sequence>
                  </bpel:scope>
                  <bpel:invoke aei:id="144044499618454339"
                               inputVariable="gSubscriptionWS"
                               name="ProcessEdicom_File"
                               operation="subscriptionWS"
                               outputVariable="gSubscriptionWSResponse"
                               partnerLink="ProcessEdicom_PLT"/>
               </bpel:sequence>
               <bpel:else aei:id="158679830080620395">
                  <bpel:empty aei:id="158679830080620399" aei:implicit="yes"/>
               </bpel:else>
            </bpel:if>
         </bpel:sequence>
      </bpel:scope>
   </bpel:sequence>
</bpel:process>
